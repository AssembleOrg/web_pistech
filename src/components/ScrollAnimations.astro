---
// Scroll animations component for enhanced UX
---

<div class="scroll-animations-controller">
  <script>
    // Intersection Observer for scroll animations
    const observerOptions = {
      threshold: [0.1, 0.3, 0.5, 0.7],
      rootMargin: '0px 0px -50px 0px'
    };

    // Elements to animate on scroll
    const animateOnScroll = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        const element = entry.target;

        if (entry.isIntersecting) {
          // Add animation classes based on element type
          if (element.classList.contains('scroll-fade-in')) {
            element.classList.add('animate-fade-in');
          }

          if (element.classList.contains('scroll-slide-up')) {
            element.classList.add('animate-slide-up');
          }

          if (element.classList.contains('scroll-slide-left')) {
            element.classList.add('animate-slide-left');
          }

          if (element.classList.contains('scroll-slide-right')) {
            element.classList.add('animate-slide-right');
          }

          if (element.classList.contains('scroll-scale-in')) {
            element.classList.add('animate-scale-in');
          }

          if (element.classList.contains('scroll-stagger')) {
            // Stagger animation for child elements
            const children = element.children;
            Array.from(children).forEach((child, index) => {
              setTimeout(() => {
                child.classList.add('animate-stagger-item');
              }, index * 150);
            });
          }

          // Special case for portfolio cards
          if (element.classList.contains('portfolio-card')) {
            setTimeout(() => {
              element.classList.add('portfolio-visible');
            }, Math.random() * 300);
          }

          // Special case for service cards
          if (element.classList.contains('service-card') || element.classList.contains('service-card-main')) {
            const delay = Array.from(element.parentNode.children).indexOf(element) * 100;
            setTimeout(() => {
              element.classList.add('service-visible');
            }, delay);
          }
        }
      });
    }, observerOptions);

    // Smooth scroll for navigation links
    const setupSmoothScroll = () => {
      document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
          e.preventDefault();
          const target = document.querySelector(this.getAttribute('href'));
          if (target) {
            target.scrollIntoView({
              behavior: 'smooth',
              block: 'start'
            });
          }
        });
      });
    };

    // Parallax effect for hero elements
    const setupParallax = () => {
      const parallaxElements = document.querySelectorAll('.parallax-element');

      window.addEventListener('scroll', () => {
        const scrolled = window.pageYOffset;
        const rate = scrolled * -0.5;

        parallaxElements.forEach(element => {
          element.style.transform = `translateY(${rate}px)`;
        });
      });
    };

    // Progress bar for scroll progress
    const setupScrollProgress = () => {
      const progressBar = document.querySelector('.scroll-progress');
      if (!progressBar) return;

      window.addEventListener('scroll', () => {
        const scrolled = window.pageYOffset;
        const maxHeight = document.documentElement.scrollHeight - window.innerHeight;
        const progress = (scrolled / maxHeight) * 100;

        progressBar.style.width = `${Math.min(progress, 100)}%`;
      });
    };

    // Header background change on scroll
    const setupHeaderScroll = () => {
      const header = document.querySelector('header');
      if (!header) return;

      window.addEventListener('scroll', () => {
        if (window.scrollY > 100) {
          header.classList.add('header-scrolled');
        } else {
          header.classList.remove('header-scrolled');
        }
      });
    };

    // Initialize everything when DOM is loaded
    document.addEventListener('DOMContentLoaded', () => {
      // Observe all elements with scroll animation classes
      const elementsToAnimate = document.querySelectorAll(`
        .scroll-fade-in,
        .scroll-slide-up,
        .scroll-slide-left,
        .scroll-slide-right,
        .scroll-scale-in,
        .scroll-stagger,
        .portfolio-card,
        .service-card,
        .service-card-main,
        .process-card
      `);

      elementsToAnimate.forEach(el => {
        // Add initial classes
        el.classList.add('scroll-element');
        animateOnScroll.observe(el);
      });

      // Setup other scroll features
      setupSmoothScroll();
      setupParallax();
      setupScrollProgress();
      setupHeaderScroll();
    });

    // Performance optimization - throttle scroll events
    let ticking = false;
    const throttleScroll = (fn) => {
      return (...args) => {
        if (!ticking) {
          requestAnimationFrame(() => {
            fn.apply(null, args);
            ticking = false;
          });
          ticking = true;
        }
      };
    };
  </script>
</div>

<style>
  /* Base scroll element styles */
  .scroll-element {
    opacity: 0;
    transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
  }

  /* Fade in animation */
  .scroll-fade-in.animate-fade-in {
    opacity: 1;
  }

  /* Slide up animation */
  .scroll-slide-up {
    transform: translateY(50px);
  }

  .scroll-slide-up.animate-slide-up {
    opacity: 1;
    transform: translateY(0);
  }

  /* Slide left animation */
  .scroll-slide-left {
    transform: translateX(-50px);
  }

  .scroll-slide-left.animate-slide-left {
    opacity: 1;
    transform: translateX(0);
  }

  /* Slide right animation */
  .scroll-slide-right {
    transform: translateX(50px);
  }

  .scroll-slide-right.animate-slide-right {
    opacity: 1;
    transform: translateX(0);
  }

  /* Scale in animation */
  .scroll-scale-in {
    transform: scale(0.8);
  }

  .scroll-scale-in.animate-scale-in {
    opacity: 1;
    transform: scale(1);
  }

  /* Stagger animation for child elements */
  .scroll-stagger > * {
    opacity: 0;
    transform: translateY(30px);
    transition: all 0.5s ease;
  }

  .animate-stagger-item {
    opacity: 1 !important;
    transform: translateY(0) !important;
  }

  /* Portfolio card animations */
  .portfolio-card {
    opacity: 0;
    transform: translateY(40px) scale(0.95);
    transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .portfolio-card.portfolio-visible {
    opacity: 1;
    transform: translateY(0) scale(1);
  }

  /* Service card animations */
  .service-card,
  .service-card-main {
    opacity: 0;
    transform: translateY(30px);
    transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .service-card.service-visible,
  .service-card-main.service-visible {
    opacity: 1;
    transform: translateY(0);
  }

  /* Process card animations */
  .process-card {
    opacity: 0;
    transform: translateX(-30px);
    transition: all 0.6s ease;
  }

  .process-card.animate-slide-right {
    opacity: 1;
    transform: translateX(0);
  }

  /* Scroll progress bar */
  .scroll-progress {
    position: fixed;
    top: 0;
    left: 0;
    width: 0%;
    height: 3px;
    background: linear-gradient(90deg, #93C572, #A3E635);
    z-index: 9999;
    transition: width 0.1s ease;
  }

  /* Header scroll effects */
  .header-scrolled {
    background: rgba(17, 18, 20, 0.95) !important;
    backdrop-filter: blur(20px) !important;
    border-bottom: 1px solid rgba(147, 197, 114, 0.2) !important;
    transition: all 0.3s ease !important;
  }

  /* Parallax elements */
  .parallax-element {
    will-change: transform;
  }

  /* Reduced motion accessibility */
  @media (prefers-reduced-motion: reduce) {
    .scroll-element,
    .portfolio-card,
    .service-card,
    .service-card-main,
    .process-card {
      transition: none !important;
      animation: none !important;
    }

    .parallax-element {
      transform: none !important;
    }

    .scroll-progress {
      display: none;
    }
  }

  /* Performance optimizations */
  .scroll-element,
  .portfolio-card,
  .service-card,
  .service-card-main {
    will-change: opacity, transform;
  }

  /* Mobile optimizations */
  @media (max-width: 768px) {
    .scroll-element {
      transition-duration: 0.4s;
    }

    .scroll-slide-up,
    .scroll-slide-left,
    .scroll-slide-right {
      transform: translateY(20px);
    }

    .scroll-scale-in {
      transform: scale(0.95);
    }
  }
</style>